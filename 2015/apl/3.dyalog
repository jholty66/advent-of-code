+f←{⍴∪0,+\(0J1 1 0J¯1 ¯1)['^>v<'⍳⍵]}	⍝ 3a
{s←(2|⍳⍴⍵)/⍵ ⋄ 1++/f¨s(⍵~s)}		⍝ 3b
